---
title: "celldex"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview  
The `celldex` package provides convenient access to several cell type reference datasets. Most of these references are derived from bulk RNA-seq or microarray data of cell populations that (hopefully) consist of a pure cell type after sorting and/or culturing. The aim is to provide a common resource for further analysis like cell type annotation of single cell expression data or deconvolution of cell type proportions in bulk expression datasets.  

Each dataset contains a log-normalized expression matrix that is intended to be comparable to log-UMI counts from common single-cell protocols (Aran et al. 2019) or gene length-adjusted values from bulk datasets. By default, gene annotation is returned in terms of gene symbols, but they can be coerced to Ensembl annotation with `ensembl=TRUE` for more robust cross-referencing across studies.  

In general, each reference provides three levels of cell type annotation in its column metadata:  

- `label.main`, broad annotation that defines the major cell types. This has few unique levels that allows for fast annotation but at low resolution.  

- `label.fine`, fine-grained annotation that defines subtypes or states. This has more unique levels that results in slower annotation but at much higher resolution.  

- `label.ont`, fine-grained annotation mapped to the standard vocabulary in the [Cell Ontology](https://www.ebi.ac.uk/ols/ontologies/cl). This enables synchronization of labels across references as well as dynamic adjustment of the resolution.  

# General-purpose references  
## Human primary cell atlas (HPCA)  
The HPCA reference consists of publicaly available microarray datasets devrived from human primary cells (Mabbott et al. 2013). Mots of the labels refer to blood subpopulations but cell types from other tissue are also available.  

```{r}
library(celldex)
ref <- HumanPrimaryCellAtlasData()
```

```{r}
colData(ref)
```

## Blueprint/ENCODE  
The Blueprint/ENCODE reference consists of bulk RNA-seq data for pure stroma and immune cells generated by Blueprint (Martens and Stunnenberg 2013) and ENCODE projects (The ENCODE Project Consortium 2012).  

```{r}
ref <- BlueprintEncodeData()
colData(ref)
```

This reference is best suited to mixed samples that do not require fine resolution, and is particularly suited for situations where easily interpretable labels are required quickly. It provides decent immune cell granularity, though it does not contain finer monocyte and dendritic cell subtypes.  

## Mouse RNA-seq  
This reference consists of a collection of mouse bulk RNA-seq data sets downloaded from the gene expression omnibus (Benayoun et al. 2019). A variety of cell types are available, again mostly from blood but also covering several other tissues.  

```{r}
ref <- MouseRNAseqData()
colData(ref)
```

# Immune references  
## Immunological Genome Project (ImmGen)
The ImmGen reference consists of microarray profiles of pure mouse immune cells from the project of the same name (Heng et al. 2008). This is currently the most highly resolved immune reference - possibly overwhelmingly so, given the granularity of the fine labels.  

```{r}
ref <- ImmGenData()
colData(ref)
```

This reference provides exhaustive coverage of a dizzying number of cell subtypes. However, this can be a double-edged sword as the high resolution can be difficult to interpret, especially for samples derived from experimental conditions that are not of interest. Users may want to remove certain samples themselves depending on the use case.  

## Database of Immune Cell Expression/eQTLs/Epigenomics (DICE)  
The DICE reference consists of bulk RNA-seq samples of sorted cell populations from the project of the same name (Schmiedel et al. 2018).  

```{r}
ref <- DatabaseImmuneCellExpressionData()
colData(ref)
```

This reference is particularly useful to those interested in CD4+ T cell subsets, though the lack of CD4+ central memory and effector memory samples may decrease accuracy in some cases. In addition, the lack of dendritic cells and a single B cell subset may result in those populations being improperly labeled or having their label pruned in a typical PBMC sample.  

## Novershtern hematopoietic data  
The Novershtern reference (previously known as Differentiation Map) consists of microarray datasets for sorted hematopoietic cell populations from GSE24759 (Novershtern et al. 2011).  

```{r}
ref <- NovershternHematopoieticData()
colData(ref)
```

This reference provides the greatest resolution for myeloid and progenitor cells among the human immune references. It has fewer T cell subsets than the other immune references but contains many more NK, erythroid, and granulocytic subsets. It is likely the best option for bone marrow samples.  

## Monaco immune data  
The Monaco reference consists of bulk RNA-seq samples of sorted immune cell populations from GSE107011 (Monaco et al. 2019).  

```{r}
ref <- MonacoImmuneData()
coldata(ref)
```

This is the human immune reference that best covers all of the bases for a typical PBMC sample. It provides expansive B and T cell subsets, differentiates between classical and non-classical monocytes, includes basic dendritic cell subsets, and also includes neutrophil and basophil samples to help identify small contaminating populations that may have slipped into a PBMC preparation.  

