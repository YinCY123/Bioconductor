---
title: "Computational genomics with R"
author: "yincy"
date: "3/27/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```


# Chapter 3 Statistics for Genomics  
```{r}
x1 <- data.frame(
    x = seq(-4, 4, 0.01), 
    y = dnorm(seq(-4,4, 0.01), 0, 0.5)
)

x2 <- data.frame(
    x = seq(-4,4, 0.01),
    y =dnorm(seq(-4,4, 0.01), 0, 1)
)

x3 <- data.frame(
    x = seq(-4,4, 0.01), 
    y = dnorm(seq(-4,4, 0.01), 0, 2)
)

x4 <- data.frame(
    x = seq(-4,4, 0.01), 
    y = dnorm(seq(-4,4, 0.01), -2, 1)
)

ggplot()+
    geom_line(aes(x, y), data = x1, color = "red") +
    geom_line(aes(x, y), data = x2, color = "blue") +
    geom_line(aes(x, y), data = x3, color = "green") +
    geom_line(aes(x, y), data = x4, color = "yellow") +
    geom_linerange(aes(x = seq(-4, -1, 0.01), ymin = -0.001, 
                       ymax = dnorm(seq(-4, -1, 0.01), 0, 1)), 
                   color = "purple")
```


```{r}
library(mosaic)
set.seed(21)
sample1 <- rnorm(50, 20, 5)

# do bootstrap resampling, sampling with replacement 
boot.means <- do(1000) * mean(resample(sample1))

# get percentile from the bootstrap means
q <- quantile(boot.means[ ,1], p = c(0.025, 0.975))

```

plot the histogram
```{r}
hist(boot.means[, 1], 
     col = "cornflowerblue", 
     border = "white", 
     xlab = "sample means")
abline(v = c(q[1], q[2]), col = "red")
text(x = q[1], y = 200, round(q[1], 3), adj = c(1,0))
text(x = q[2], y = 200, round(q[2], 3), adj = c(0, 0))
```


```{r, fig.align='center'}
knitr::include_graphics(path = "f:/git/Bioconductor/Books/Computational genomics with R/figures/interval.PNG")
```

```{r}
alpha = 0.05
sd = 5
n = 50
mean(sample1) + qnorm(c(alpha/2, 1-alpha/2)) * sd/sqrt(n)
```


### 3.2.2 randomization based testing for difference of the means























































